define(["jquery","bestpay.ui","bestpay.lang","bestpay.http"],function(c,f,b,e){var d=null;function a(){d=this;this.userInfo=JSON.parse(Bestpay.User.getSuccessLoginInfo());console.log("userInfo============="+JSON.stringify(userInfo));this.selectCityCode=this.userInfo.areaCode;console.log("-----------selectCityCode:"+this.selectCityCode);this.brgAmount=null;this.cardAmount="10";this.quickTranInfo={};this.itemValue="02";this.random=null;this.itMobile=null;this.ipPassword=null;this.mailRecept=null;this.mailMobile=null;this.mailAddress=null;this.violationRecord=null;this.violationRecordJson={};this.orderPageJson={};this.successJson={};this.canProcess=false;this.hzTips=false;this.arrRecordJson=[];this.sureOrder={};this.sureOrderPage={};this.isPost="false";this.systemNo=null;this.payType="0";this.checkBillCheck=false;this.TrafficfinesData={};this.productId="0030001";this.deffered=null;this.paymentPlugin=null;this.businessName="交通罚款"}a.prototype.initApp=function(){config.TRADE_LIST_QUERY_TYPE=config.BUS_TYPE.BUS_TYPE_TRAFFIC_FINES;var g=this;goTo(config.page.main,function(){});g.car_number=new f.InputText("car_number","AlphaNumeric");g.chassis_number=new f.InputText("chassis_number","AlphaNumeric");g.engine_number=new f.InputText("engine_number","engineNumber");g.car_number.clearValue();g.chassis_number.clearValue();g.engine_number.clearValue();g.mailRecept=new f.InputText("mail_recept");g.mailMobile=new f.InputText("mail_moblie","mobile");g.mailAddress=new f.InputText("mail_address");g.btnInit()};a.prototype.btnInit=function(){var g=this;g.getCarCode();c("#city,#cardNum").on("click",function(){g.accepCityName="";goTo(config.page.selectPage,function(){g.getAreaInfo()})});document.getElementById("id_selectProBtn").onclick=function(){if(g.accepCityName==""){Bestpay.Toast.makeText("请选择车牌",Bestpay.Toast.LENGTH_SHORT);return}d.accepCityCode=d.accepCityCode_data;d.accepProvinceCode=d.accepCityCode.slice(0,2);d.carNumberPrefix=d.carNumberPrefix_data;console.log(d.accepProvinceCode+" "+d.accepCityCode);c("#cardNum").html(d.carNumberPrefix);c("#city").html(d.city);back()};document.getElementById("btn_next").onclick=function(){g.checkBillCheck=false;g.fine_Query()}};a.prototype.getAreaInfo=function(){var h=this;var g=Bestpay.DB_Data.getTrafficProvinces();console.log(JSON.stringify(g));h.areaInfoSuccessCallback(g)};a.prototype.areaInfoSuccessCallback=function(h){var k=h;var m="";for(var j=0,g=k.length;j<g;j++){var l=k[j];m+='<span id="'+l.code+'" data-code="'+l.code+'">'+l.prefix+"（"+l.name+"）</span>"}c("#id_optionsBoxLeft").html("").append(m);c("#id_optionsBoxLeft span").css("height","auto");c("#"+d.accepProvinceCode).addClass("selectSpan");c("#id_optionsBoxLeft").show();c("#id_optionsBoxRight").html("").show();d.getProvinceCode()};a.prototype.getCarCode=function(){var g=this;var h=g.selectCityCode.slice(0,2);var i=g.selectCityCode.slice(0,4);var k=Bestpay.DB_Data.getTrafficCitiesByProvinceId(h);var j=new RegExp("{[^}]*"+i+"[^}]*}","g");k=JSON.stringify(k);console.log("cityList="+k);var l=k.match(j);console.log("234cityArray="+l);l=JSON.parse(l);if(!l){l=JSON.parse(k)[0]}console.log("cityArray="+l);g.accepProvinceCode=h;g.accepCityCode=l.cityID;g.carCodeLen=l.carCodeLen;g.carEngineLen=l.carEngineLen;console.log("self.carEngineLen == "+g.carEngineLen);g.accepCityName=l.name;g.carNumberPrefix=l.carNumberPrefix;c("#cardNum").html(g.carNumberPrefix);c("#city").html(g.accepCityName);g.provinceCheck();g.carTypeClick()};a.prototype.getProvinceCode=function(){var g=this;d.getCityCode(Bestpay.DB_Data.getTrafficCitiesByProvinceId(g.accepProvinceCode));c("#id_optionsBoxLeft span").each(function(){c(this).on("click",function(){d.accepProvinceCode_data=c(this).data("code");var h=Bestpay.DB_Data.getTrafficCitiesByProvinceId(d.accepProvinceCode_data);console.log(JSON.stringify(h));d.accepProvinceName=c(this).html();Bestpay.App.setTitle(d.accepProvinceName);c("#id_optionsBoxLeft .selectSpan").removeClass("selectSpan");c(this).addClass("selectSpan");d.getCityCode(h)})})};a.prototype.getCityCode=function(m){var h=this;var k=m;var l="";for(var j=0,g=k.length;j<g;j++){var n=k[j];l+='<span id="'+n.cityID+'" data-code="'+n.carCodeLen+":"+n.carEngineLen+'" data-city="'+n.name+'" title="'+n.carNumberPrefix+'">'+n.carNumberPrefix+"（"+n.name+"）</span>"}c("#id_optionsBoxRight").html("").append(l);c("#id_optionsBoxRight span").css("height","auto");c("#id_optionsBoxRight").show();c("#id_optionsBoxRight span").each(function(){c(this).on("click",function(){var i=c(this).data("code").split(":");d.accepCityCode_data=c(this).attr("id");d.carCodeLen=i[0];d.carEngineLen=i[1];d.accepCityName=c(this).html();d.city=c(this).data("city");d.carNumberPrefix_data=c(this).attr("title");Bestpay.App.setTitle(d.accepCityName);c("#id_optionsBoxRight .selectSpan").removeClass("selectSpan");c(this).addClass("selectSpan");d.accepCityCode=d.accepCityCode_data;d.accepProvinceCode=d.accepCityCode.slice(0,2);d.carNumberPrefix=d.carNumberPrefix_data;console.log(d.accepProvinceCode+" "+d.accepCityCode);c("#cardNum").html(d.carNumberPrefix);c("#city").html(d.city);back()})})};a.prototype.carTypeClick=function(){c("#carType div").on("click",function(){c(this).addClass("raido-on").removeClass("raido-off");c(this).siblings().addClass("raido-off").removeClass("raido-on");d.itemValue=c(this).attr("title")})};a.prototype.provinceCheck=function(){if(d.carCodeLen==="0"){c("#chassis_number").attr("placeholder","不用输入车架号")}else{if(d.carCodeLen==="99"){c("#chassis_number").attr("placeholder","请输入完整车架号")}else{c("#chassis_number").attr("placeholder","车架号后"+d.carCodeLen+"位")}}if(d.carEngineLen==="0"){c("#engine_number").attr("placeholder","不用输入发动机号")}else{if(d.carEngineLen==="99"){c("#engine_number").attr("placeholder","请输入完整发动机号")}else{c("#engine_number").attr("placeholder","发动机号后"+d.carEngineLen+"位")}}};a.prototype.fine_Query=function(){this.car_number_val=this.car_number.getToEmptyValue();this.chassis_number_val=this.chassis_number.getToEmptyValue();this.engine_number_val=this.engine_number.getToEmptyValue();var g=this;if(this.car_number_val==null||this.car_number_val.length==0){Bestpay.Toast.makeText("请输入车牌号",Bestpay.Toast.LENGTH_SHORT);return}else{if(d.carCodeLen!=="0"&&(this.chassis_number_val==null||this.chassis_number_val.length==0)){Bestpay.Toast.makeText("请填写车身架号",Bestpay.Toast.LENGTH_SHORT);return}else{if(d.carEngineLen!=="0"&&(this.engine_number_val==null||this.engine_number_val.length==0)){Bestpay.Toast.makeText("请填发动机号",Bestpay.Toast.LENGTH_SHORT);return}}}g.orderPageJson={};g.orderPageJson.car_number_val=d.carNumberPrefix+""+this.car_number_val;g.orderPageJson.chassis_number_val=this.chassis_number_val;g.orderPageJson.engine_number_val=this.engine_number_val;d.mailRecept.clearValue();d.mailMobile.clearValue();d.mailAddress.clearValue();showDialog(config.MSG.loading);g.stpyque()};a.prototype.stpyque=function(){var g=this;e.callCPSService({service:config.CPS.STPYQUE,params:g.stpyqueParams(),showLoading:false,success:g.stpyqueSuccessCallback,error:g.stpyqueErrorCallback})};a.prototype.stpyqueParams=function(){var g=this;var h={searchNo:g.orderPageJson.car_number_val,carType:d.itemValue,carCode:g.orderPageJson.chassis_number_val,carDriveNum:g.orderPageJson.engine_number_val,provinceId:d.accepProvinceCode,cityId:d.accepCityCode,carOwner:""};h=e.setCPSCommonParams(h);console.log("交通罚款查询 STpy001 入参======="+JSON.stringify(h));return h};a.prototype.stpyqueSuccessCallback=function(h){if(h.code!==config.RES.SUCCESS){if(h.code==config.RES.MONEY_NOT_ENOUGH){Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",h.code,function(){});return}if(h.code==config.RES.PASSWORD_ERROR_LOCKED_002136){Bestpay.Dialog.showAlertDialog("提醒",h.content,"确定",h.code,function(){App.exitCompleteApp()})}else{Bestpay.Dialog.showAlertDialog("提醒",h.content,"确定",h.code)}return}console.log("交通罚款查询 STpy001出参========"+JSON.stringify(h));d.sureOrder.carOwner=h.carOwner==null?"":h.carOwner;d.sureOrderPage={};d.violationRecord=JSON.parse(h.violationRecord.replace('"','"'));d.systemNo=h.systemNo;if(!d.violationRecord.length){dismissDialog();Bestpay.Dialog.showAlertDialog("查询结果","恭喜！未查到违章记录。","确定","");return}c("#carOwner").html(d.sureOrder.carOwner);c("#orderCount").html(d.violationRecord.length);console.error("systemNo:==============================="+d.systemNo);d.arrRecordJson=[];c("#id_confirm_wrap_illegal").html("");d.canProcess=false;d.violationRecord.forEach(function(j,k){d.arrRecordJson[k]={};var m=d.arrRecordJson[k];var l=j.time.split(" ");m.punish_number=j.archive;m.violation_day=l[0];m.violation_hour=l[1];m.illegal_place=j.location;m.illegal_reasons=j.reason;m.license_points=j.degree;m.penal_sum=parseFloat(j.count).toFixed(2);m.overdue_fine=parseFloat(j.latefine).toFixed(2);m.agency_fee=parseFloat(j.cooperPoundge*1+5).toFixed(2);d.rewardself=d.arrRecordJson[k]["reward"]=j.count*1+j.latefine*1+(j.cooperPoundge*1+5);console.log("手续费"+m.agency_fee);console.log("count"+j.count);console.log("latefine"+j.latefine);console.log("cooperPoundge"+(j.cooperPoundge*1+5));console.log("酬金 = 违章罚款金额 + 滞纳金 + 手续费"+d.rewardself);if(j.canProcess==="0"){m.handling_state="不可办理";m.hz_display="none"}else{if(j.canProcess==="1"){console.log(d.accepProvinceCode+"-------------------------");if(d.accepProvinceCode=="44"){c("#need_receipt").show()}else{c("#need_receipt").hide()}m.handling_state="可办理";m.bl_check=k;m.hz_display="block";d.canProcess=true}}});console.error(JSON.stringify(d.arrRecordJson));var g=new f.Template();g.template_MoreToOne("illegal_JSON","id_confirm_wrap_illegal",d.arrRecordJson);dismissDialog();goTo(config.page.illegal,function(){var j=null;var i=[];c(".bl_check").on("click",function(){var k=c(this).data("code");console.error("code: "+k);if(c(this).hasClass("raido-on")){c(this).removeClass("raido-on");j=null}else{c(".bl_check").removeClass("raido-on");c(this).addClass("raido-on");j=k;console.error("arrRecordJson=========================="+JSON.stringify(d.arrRecordJson[j]));d.sureOrder.penal_sum=parseInt(d.arrRecordJson[j]["penal_sum"]);d.sureOrder.orderSeq=d.arrRecordJson[j]["punish_number"];d.sureOrder.TempID=d.violationRecord[j]["secondaryUniqueCode"];d.sureOrder.cooperPoundge=parseInt(d.arrRecordJson[j]["agency_fee"]);d.sureOrderPage.Name="";d.sureOrderPage.Phone="";d.sureOrderPage.Address="";console.error("orderSeq============="+d.arrRecordJson[j]["punish_number"])}});c("#need_receipt").on("click",function(){var k=d.arrRecordJson.bl_code;if(c(this).hasClass("raido-on")){c(this).removeClass("raido-on").addClass("raido-off");c("#sendPost_id").removeClass("sendPostShow");c("#hz_or_not").val("no")}else{c(this).addClass("raido-on").removeClass("raido-off");c("#sendPost_id").addClass("sendPostShow");c("#hz_or_not").val("yes")}});c(".illegal_list").on("click",function(){var k=c(this).parent().next(".sub-item");if(c(this).hasClass("action-up")){c(this).removeClass("action-up");k.removeClass("show-sub-item")}else{c(this).addClass("action-up");k.addClass("show-sub-item")}});document.getElementById("btn_sure").onclick=function(){if(!d.canProcess){Bestpay.Dialog.showAlertDialog("温馨提示","当前没有可缴费的记录！","确定","",function(){back()});return}if(j===null){Bestpay.Toast.makeText("请选择一张订单",Bestpay.Toast.LENGTH_SHORT);return}if(c("#hz_or_not").val()==="yes"){d.isPost="true";var k=d.mailMobile.getToEmptyValue();if(!d.mailRecept.getValue()){Bestpay.Toast.makeText("请填写收件人",Bestpay.Toast.LENGTH_SHORT);return}else{if(!k){Bestpay.Toast.makeText("请填写收件人电话号码",Bestpay.Toast.LENGTH_SHORT);return}else{if(k.length>0&&(k.length<11||k.length>11)){Bestpay.Toast.makeText("您输入的手机号码长度错误！",Bestpay.Toast.LENGTH_SHORT);return}else{if(!d.mailAddress.getValue()){Bestpay.Toast.makeText("请填写收件人地址",Bestpay.Toast.LENGTH_SHORT);return}}}}d.sureOrderPage.Name=d.mailRecept.getValue();d.sureOrderPage.Phone=d.mailMobile.getValue();d.sureOrderPage.Address=d.mailAddress.getValue()}console.log("=================go to 酬金 ==================");console.log("sureOrderPage=="+JSON.stringify(d.sureOrderPage));d.itJudgeLocalStorage=new f.JudgeLocalStorage();d.itJudgeLocalStorage.checkOrder(d.sureOrderPage.searchNo,d.sureOrderPage.amount_val*1,e.getCurrentTime(),function(){d.queryStart();d.callQuickTradingQuery();d.defferred.done(d.goPayAnimation)},d.businessName)}})};a.prototype.gotoOrder=function(g){e.getRandomServices(function(h){var i=h;if(h.code===config.RES.SUCCESS){d.random=h.randNum}d.gotoRecharge(g)},false)};a.prototype.queryStart=function(){var g=this;g.defferred=c.Deferred();showDialog()};a.prototype.queryEnd=function(){var g=this;var h={businessName:g.businessName,accountName:"交通罚款",accouontValue:g.sureOrderPage.searchNo,rechargeMoney:g.sureOrderPage.amount_val,rewardMoney:g.sureOrderPage.reward,jfyBalance:g.orderPageJson.jfy_amount,tybBalance:g.orderPageJson.tyb_amount,enablePassword:g.noPwd,userInfo:g.userInfo,callback:g.gotoOrder};console.log("pluginParam = "+JSON.stringify(h));g.paymentPlugin=new f.paymentPlugin(h);dismissDialog();goTo(config.page.comfirm,function(){});g.defferred.resolve()};a.prototype.goPayAnimation=function(){console.log("done=========================");c("#order_comfirm").removeClass("backPayAnimation").addClass("goPayAnimation")};a.prototype.stpyqueErrorCallback=function(g){if(g.code===config.RES.MONEY_NOT_ENOUGH){Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",g.code,function(){});return}};a.prototype.stpyOrderQuery=function(){var g=this;e.callCPSService({service:config.CPS.STPY_ORDER,params:d.stpyOrderqueParams(),showLoading:false,success:d.stpyOrderqueSuccessCallback,error:d.stpyOrderqueErrorCallback})};a.prototype.stpyOrderqueParams=function(){var g=this;var h={searchNo:d.orderPageJson.car_number_val,searchTime:b.getDate_YYYYMMDD()+""+b.getTime_HHMMSS()};h=e.setCPSCommonParams(h);console.log("交通罚款违章订单查询 STpy002 入参======="+JSON.stringify(h));return h};a.prototype.stpyOrderqueSuccessCallback=function(g){if(g.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code)}console.log("交通罚款违章订单查询 STpy002出参========"+JSON.stringify(g))};a.prototype.callQuickTradingQuery=function(){var g=this;e.callCPSService({service:config.CPS.QUICK_TRADING_QUERY,params:g.quickTradingQueryParams(),showLoading:false,success:g.quickTradingQuerySuccessCallback})};a.prototype.quickTradingQueryParams=function(){var g=this;var h={};h=e.setCPSCommonParams(h);console.log("免密交易查询接口入参"+JSON.stringify(h));return h};a.prototype.quickTradingQuerySuccessCallback=function(g){console.log("=======免密交易查询成功=======");if(g.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code);return}console.log("免密交易查询接口出参"+JSON.stringify(g));d.quickTranInfo={perAmount:g.perAmount,allAmount:g.allamount,allTransAction:g.alltransaction};d.handleIsneedpassword()};a.prototype.handleIsneedpassword=function(){var g=this;var i=d.quickTranInfo;var h=b.yuan2fen(d.sureOrder.penal_sum+d.sureOrder.cooperPoundge);console.log("amount : "+h);console.log("quickTranInfo : "+JSON.stringify(i));if(h*1<=1*i.perAmount&&(h*1+1*i.allTransAction)<=1*i.allAmount){d.noPwd=false}else{d.noPwd=true}console.log("self.userInfo.authenStatus=="+g.userInfo.authenStatus);if(g.userInfo.authenStatus=="A02"){console.log("self.userInfo.hadEpt  "+g.userInfo.hadEpt);if(g.userInfo.hadEpt==1){g.getFinancialProducts()}else{g.fundAccountBalanceInquiry()}}else{g.fundAccountBalanceInquiry()}};a.prototype.getFinancialProducts=function(){var g=this;e.callCPSService({service:config.CPS.FINANCIAL_PRODUCTS,params:g.getFinancialProductsParams(),showLoading:false,success:g.getFinancialProductsSuccessCallback})};a.prototype.getFinancialProductsParams=function(){var g=this;var h={};h=e.setCPSCommonParams(h);return h};a.prototype.getFinancialProductsSuccessCallback=function(g){if(g.code!==config.RES.SUCCESS){if(g.code==="018888"){d.fundAccountBalanceInquiry();return}else{Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code);return}}var j=g.datas;for(var h=0;h<j.length;h++){d.orderPageJson.productId=j[h]["productId"];d.orderPageJson.userId=j[h]["userId"];d.orderPageJson.tyb_amount=b.fen2yuan(j[h]["balance"])}d.fundAccountBalanceInquiry()};a.prototype.fundAccountBalanceInquiry=function(){var g=this;e.callCPSService({service:config.CPS.CCOUNT_BALANCE_QUERY,params:g.fundAccountBalanceInquiryParams(),showLoading:false,success:g.fundAccountBalanceInquirySuccessCallback})};a.prototype.fundAccountBalanceInquiryParams=function(){var g=this;var h={bankMode:g.userInfo.bankMode};h=e.setCPSCommonParams(h);return h};a.prototype.fundAccountBalanceInquirySuccessCallback=function(t){if(t.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",t.content,"确定",t.code);return}console.log("资金账户余额查询 SAcc003出参======="+JSON.stringify(t));var r=t.dayLimit;var h=t.dayTotal;var k=r*1-h*1;var g=t.monthLimit;var n=t.monthTotal;var m=g*1-n*1;var p=t.motherBoard;var o=t.accountItems;for(var l=0;l<o.length;l++){var q=o[l]["acctType"];if(q!=null||q!="null"||q!="undefined"||q!=""){if("0007"==q){var j=o[l].activeBalance;d.orderPageJson.jfy_amount=b.fen2yuan(j);break}}}if(config.CARD_TYPE.BANK_MODE_FUND_POOL_MEMBER_CARD===d.userInfo.bankMode){var s="";if(r==="0"){s=p}else{if(p>k){s=k}else{s=p}}if(g==="0"){s=p}else{if(p>m){s=m}else{s=p}}d.orderPageJson.jfy_amount=b.fen2yuan(s);console.log("子卡＝＝＝＝trafficfinesSelf.orderPageJson['jfy_amount']=="+d.orderPageJson.jfy_amount)}d.getCommission()};a.prototype.getCommission=function(){var g=this;console.log("酬金查询金额："+b.yuan2fen(d.sureOrder.penal_sum));console.log("酬金 = 违章罚款金额 + 滞纳金 + 手续费"+d.rewardself);e.getCommission(config.BUS_TYPE.BUS_TYPE_TRAFFIC_FINES,config.BUS_CODE.TRAFFIC_FINES,config.BUS_CODE.TRAFFIC_FINES,d.rewardself,function(h){var i=h;if(h.code===config.RES.SUCCESS){i.commission=b.fen2yuan(h.reward)}else{if(h.code===config.CODE.COMMOSSION_ERROR){i.code=config.RES.SUCCESS;i.commission="0.00"}else{i.code=config.RES.UNKNOWN_ERROR;i.content=config.RES.UNKNOWN_ERROR_MSG}}d.reward=i.commission;console.log("commission================="+i.commission);showDialog(config.MSG.loading);d.initConfirm()},false)};a.prototype.initConfirm=function(){var g=this;console.log("订单页面初始化");c("#mailAddress").hide();d.sureOrderPage.searchNo=(d.orderPageJson.car_number_val).toUpperCase();d.sureOrderPage.carOwner=d.sureOrder.carOwner;d.sureOrderPage.amount_val=d.sureOrder.penal_sum+d.sureOrder.cooperPoundge;d.sureOrderPage.reward=d.reward;if(!!d.sureOrderPage.Address){c("#mailAddress").show()}console.log(JSON.stringify(d.sureOrderPage));g.queryEnd()};a.prototype.gotoRecharge=function(h){var g=this;config.TRADE_LIST_QUERY_NUMBER=g.orderPageJson.car_number_val;config.isBack=function(){back()};e.getRandomServices(function(i){var j=i;if(i.code===config.RES.SUCCESS){d.random=i.randNum}d.transportationFinesPayment(h)},false)};a.prototype.transportationFinesPayment=function(h){var g=this;e.callCPSService({service:config.CPS.TRANSPORTATION_FINES_PAYMENT,params:d.transportationFinesPaymentParams(h),showLoading:true,success:d.transportationFinesPaymentSuccessCallback,error:d.transportationFinesPaymentErrorCallback})};a.prototype.transportationFinesPaymentParams=function(j){var g=this;var h="";if(j!=null&&j!=""){h=j}console.log("trafficfinesSelf.carEngineLen == "+d.carEngineLen);var i={passWord:Bestpay.Security.encryptPassword(g.userInfo.staffCode,h,g.random),payAmount:b.yuan2fen(d.sureOrderPage.amount_val),systemNo:d.systemNo,payCardCode:g.orderPageJson.car_number_val,carEngine:g.orderPageJson.engine_number_val,carCode:g.orderPageJson.chassis_number_val,isPost:d.isPost,orderConfig:'{"Name":"'+d.sureOrderPage.Name+'","Phone":"'+d.sureOrderPage.Phone+'","CardNo":"","Address":"'+d.sureOrderPage.Address+'"}',preOrderDetails:'[{"TempID":"'+d.sureOrder.TempID+'"}]',orderSeq:b.getDate_YYYYMMDD()+""+b.getTime_HHMMSS(),payTime:b.getDate_YYYYMMDD()+""+b.getTime_HHMMSS()};i.phone="";if(g.userInfo.hadEpt.toString()=="1"){i.costWay=g.paymentPlugin.getPayType();i.productId=g.productId;i.userId=g.orderPageJson.userId}i=e.setCPSCommonParams(i);i.preOrderDetails=['{"TempID":"'+d.sureOrder.TempID+'"}'];console.log("交通罚款缴费 TTpy003 入参======="+JSON.stringify(i));d.sureOrderPage.orderSeq=i.orderSeq;return i};a.prototype.transportationFinesPaymentSuccessCallback=function(g){console.log("result==========="+JSON.stringify(g));PasswordKeyBoard.hideKeyboardUI3();if(g.code!==config.RES.SUCCESS){if(g.code==config.RES.MONEY_NOT_ENOUGH){Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",g.code,function(){d.itJudgeLocalStorage.putLocalValue("","","","")});return}if(g.code=="009002"||g.code=="006751"){d.paymentPlugin.setOrderDisplay("overtime");goTo(config.page.page_float);return}if(g.code=="019998"){Bestpay.Dialog.showAlertDialog("交易结果","系统处理失败，请稍后再试","确定",g.code,function(){back();d.itJudgeLocalStorage.putLocalValue("","","","")});return}if(g.code==config.RES.PASSWORD_ERROR_LOCKED_002136){Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code,function(){App.exitCompleteApp();d.itJudgeLocalStorage.putLocalValue("","","","")})}else{Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code,function(){back();d.itJudgeLocalStorage.putLocalValue("","","","")})}return}d.itJudgeLocalStorage.putLocalValue("","","","");d.paymentPlugin.setOrderDisplay("success");goTo(config.page.page_float);config.isBack=function(){if(window.jqXHR.readyState>2){Bestpay.App.exitApp()}}};a.prototype.transportationFinesPaymentErrorCallback=function(g){console.log("result error==========="+JSON.stringify(g));if(g.code===config.RES.MONEY_NOT_ENOUGH){d.itJudgeLocalStorage.putLocalValue("","","","");Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",g.code,function(){});return}};return a});