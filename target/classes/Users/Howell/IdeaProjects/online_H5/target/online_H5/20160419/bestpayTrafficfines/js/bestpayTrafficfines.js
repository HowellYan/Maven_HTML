define(["jquery","bestpay.ui","bestpay.lang","bestpay.http"],function(a,d,f,c){var b=null;function e(){b=this;this.userInfo=JSON.parse(Bestpay.User.getSuccessLoginInfo());console.log("userInfo============="+JSON.stringify(userInfo));this.selectCityCode=this.userInfo.areaCode;console.log("-----------selectCityCode:"+this.selectCityCode);this.brgAmount=null;this.cardAmount="10";this.quickTranInfo={};this.itemValue="02";this.random=null;this.itMobile=null;this.ipPassword=null;this.mailRecept=null;this.mailMobile=null;this.mailAddress=null;this.violationRecord=null;this.violationRecordJson={};this.orderPageJson={};this.successJson={};this.canProcess=false;this.hzTips=false;this.arrRecordJson=[];this.sureOrder={};this.sureOrderPage={};this.isPost="false";this.systemNo=null;this.payType="0";this.checkBillCheck=false;this.TrafficfinesData={};this.productId="0030001";this.deffered=null;this.paymentPlugin=null;this.businessName="交通罚款"}e.prototype.initApp=function(){config.TRADE_LIST_QUERY_TYPE=config.BUS_TYPE.BUS_TYPE_TRAFFIC_FINES;var g=this;goTo(config.page.main,function(){});g.car_number=new d.InputText("car_number","AlphaNumeric");g.chassis_number=new d.InputText("chassis_number","AlphaNumeric");g.engine_number=new d.InputText("engine_number","engineNumber");g.car_number.clearValue();g.chassis_number.clearValue();g.engine_number.clearValue();g.mailRecept=new d.InputText("mail_recept");g.mailMobile=new d.InputText("mail_moblie","mobile");g.mailAddress=new d.InputText("mail_address");g.btnInit()};e.prototype.btnInit=function(){var g=this;g.getCarCode();a("#city,#cardNum").on("click",function(){g.accepCityName="";goTo(config.page.selectPage,function(){g.getAreaInfo()})});document.getElementById("id_selectProBtn").onclick=function(){if(g.accepCityName==""){Bestpay.Toast.makeText("请选择车牌",Bestpay.Toast.LENGTH_SHORT);return}b.accepCityCode=b.accepCityCode_data;b.accepProvinceCode=b.accepCityCode.slice(0,2);b.carNumberPrefix=b.carNumberPrefix_data;console.log(b.accepProvinceCode+" "+b.accepCityCode);a("#cardNum").html(b.carNumberPrefix);a("#city").html(b.city);back()};document.getElementById("btn_next").onclick=function(){g.checkBillCheck=false;g.fine_Query()}};e.prototype.getAreaInfo=function(){var h=this;var g=Bestpay.DB_Data.getTrafficProvinces();console.log(JSON.stringify(g));h.areaInfoSuccessCallback(g)};e.prototype.areaInfoSuccessCallback=function(j){var l=j;var h="";for(var k=0,i=l.length;k<i;k++){var g=l[k];h+='<span id="'+g.code+'" data-code="'+g.code+'">'+g.prefix+"（"+g.name+"）</span>"}a("#id_optionsBoxLeft").html("").append(h);a("#id_optionsBoxLeft span").css("height","auto");a("#"+b.accepProvinceCode).addClass("selectSpan");a("#id_optionsBoxLeft").show();a("#id_optionsBoxRight").html("").show();b.getProvinceCode()};e.prototype.getCarCode=function(){var i=this;var j=i.selectCityCode.slice(0,2);var k=i.selectCityCode.slice(0,4);var g=Bestpay.DB_Data.getTrafficCitiesByProvinceId(j);var l=new RegExp("{[^}]*"+k+"[^}]*}","g");g=JSON.stringify(g);console.log("cityList="+g);var h=g.match(l);console.log("234cityArray="+h);h=JSON.parse(h);if(!h){h=JSON.parse(g)[0]}console.log("cityArray="+h);i.accepProvinceCode=j;i.accepCityCode=h.cityID;i.carCodeLen=h.carCodeLen;i.carEngineLen=h.carEngineLen;console.log("self.carEngineLen == "+i.carEngineLen);i.accepCityName=h.name;i.carNumberPrefix=h.carNumberPrefix;a("#cardNum").html(i.carNumberPrefix);a("#city").html(i.accepCityName);i.provinceCheck();i.carTypeClick()};e.prototype.getProvinceCode=function(){var g=this;b.getCityCode(Bestpay.DB_Data.getTrafficCitiesByProvinceId(g.accepProvinceCode));a("#id_optionsBoxLeft span").each(function(){a(this).on("click",function(){b.accepProvinceCode_data=a(this).data("code");var h=Bestpay.DB_Data.getTrafficCitiesByProvinceId(b.accepProvinceCode_data);console.log(JSON.stringify(h));b.accepProvinceName=a(this).html();Bestpay.App.setTitle(b.accepProvinceName);a("#id_optionsBoxLeft .selectSpan").removeClass("selectSpan");a(this).addClass("selectSpan");b.getCityCode(h)})})};e.prototype.getCityCode=function(h){var j=this;var m=h;var g="";for(var l=0,i=m.length;l<i;l++){var k=m[l];g+='<span id="'+k.cityID+'" data-code="'+k.carCodeLen+":"+k.carEngineLen+'" data-city="'+k.name+'" title="'+k.carNumberPrefix+'">'+k.carNumberPrefix+"（"+k.name+"）</span>"}a("#id_optionsBoxRight").html("").append(g);a("#id_optionsBoxRight span").css("height","auto");a("#id_optionsBoxRight").show();a("#id_optionsBoxRight span").each(function(){a(this).on("click",function(){var n=a(this).data("code").split(":");b.accepCityCode_data=a(this).attr("id");b.carCodeLen=n[0];b.carEngineLen=n[1];b.accepCityName=a(this).html();b.city=a(this).data("city");b.carNumberPrefix_data=a(this).attr("title");Bestpay.App.setTitle(b.accepCityName);a("#id_optionsBoxRight .selectSpan").removeClass("selectSpan");a(this).addClass("selectSpan");b.accepCityCode=b.accepCityCode_data;b.accepProvinceCode=b.accepCityCode.slice(0,2);b.carNumberPrefix=b.carNumberPrefix_data;console.log(b.accepProvinceCode+" "+b.accepCityCode);a("#cardNum").html(b.carNumberPrefix);a("#city").html(b.city);back()})})};e.prototype.carTypeClick=function(){a("#carType div").on("click",function(){a(this).addClass("raido-on").removeClass("raido-off");a(this).siblings().addClass("raido-off").removeClass("raido-on");b.itemValue=a(this).attr("title")})};e.prototype.provinceCheck=function(){if(b.carCodeLen==="0"){a("#chassis_number").attr("placeholder","不用输入车架号")}else{if(b.carCodeLen==="99"){a("#chassis_number").attr("placeholder","请输入完整车架号")}else{a("#chassis_number").attr("placeholder","车架号后"+b.carCodeLen+"位")}}if(b.carEngineLen==="0"){a("#engine_number").attr("placeholder","不用输入发动机号")}else{if(b.carEngineLen==="99"){a("#engine_number").attr("placeholder","请输入完整发动机号")}else{a("#engine_number").attr("placeholder","发动机号后"+b.carEngineLen+"位")}}};e.prototype.fine_Query=function(){this.car_number_val=this.car_number.getToEmptyValue();this.chassis_number_val=this.chassis_number.getToEmptyValue();this.engine_number_val=this.engine_number.getToEmptyValue();var g=this;if(this.car_number_val==null||this.car_number_val.length==0){Bestpay.Toast.makeText("请输入车牌号",Bestpay.Toast.LENGTH_SHORT);return}else{if(b.carCodeLen!=="0"&&(this.chassis_number_val==null||this.chassis_number_val.length==0)){Bestpay.Toast.makeText("请填写车身架号",Bestpay.Toast.LENGTH_SHORT);return}else{if(b.carEngineLen!=="0"&&(this.engine_number_val==null||this.engine_number_val.length==0)){Bestpay.Toast.makeText("请填发动机号",Bestpay.Toast.LENGTH_SHORT);return}}}g.orderPageJson={};g.orderPageJson.car_number_val=b.carNumberPrefix+""+this.car_number_val;g.orderPageJson.chassis_number_val=this.chassis_number_val;g.orderPageJson.engine_number_val=this.engine_number_val;b.mailRecept.clearValue();b.mailMobile.clearValue();b.mailAddress.clearValue();showDialog(config.MSG.loading);g.stpyque()};e.prototype.stpyque=function(){var g=this;c.callCPSService({service:config.CPS.STPYQUE,params:g.stpyqueParams(),showLoading:false,success:g.stpyqueSuccessCallback,error:g.stpyqueErrorCallback})};e.prototype.stpyqueParams=function(){var g=this;var h={searchNo:g.orderPageJson.car_number_val,carType:b.itemValue,carCode:g.orderPageJson.chassis_number_val,carDriveNum:g.orderPageJson.engine_number_val,provinceId:b.accepProvinceCode,cityId:b.accepCityCode,carOwner:""};h=c.setCPSCommonParams(h);console.log("交通罚款查询 STpy001 入参======="+JSON.stringify(h));return h};e.prototype.stpyqueSuccessCallback=function(h){if(h.code!==config.RES.SUCCESS){if(h.code==config.RES.MONEY_NOT_ENOUGH){Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",h.code,function(){});return}if(h.code==config.RES.PASSWORD_ERROR_LOCKED_002136){Bestpay.Dialog.showAlertDialog("提醒",h.content,"确定",h.code,function(){App.exitCompleteApp()})}else{Bestpay.Dialog.showAlertDialog("提醒",h.content,"确定",h.code)}return}console.log("交通罚款查询 STpy001出参========"+JSON.stringify(h));b.sureOrder.carOwner=h.carOwner==null?"":h.carOwner;b.sureOrderPage={};b.violationRecord=JSON.parse(h.violationRecord.replace('"','"'));b.systemNo=h.systemNo;if(!b.violationRecord.length){dismissDialog();Bestpay.Dialog.showAlertDialog("查询结果","恭喜！未查到违章记录。","确定","");return}a("#carOwner").html(b.sureOrder.carOwner);a("#orderCount").html(b.violationRecord.length);console.error("systemNo:==============================="+b.systemNo);b.arrRecordJson=[];a("#id_confirm_wrap_illegal").html("");b.canProcess=false;b.violationRecord.forEach(function(i,j){b.arrRecordJson[j]={};var l=b.arrRecordJson[j];var k=i.time.split(" ");l.punish_number=i.archive;l.violation_day=k[0];l.violation_hour=k[1];l.illegal_place=i.location;l.illegal_reasons=i.reason;l.license_points=i.degree;l.penal_sum=parseFloat(i.count).toFixed(2);l.overdue_fine=parseFloat(i.latefine).toFixed(2);l.agency_fee=parseFloat(i.cooperPoundge*1+5).toFixed(2);b.rewardself=b.arrRecordJson[j]["reward"]=i.count*1+i.latefine*1+(i.cooperPoundge*1+5);console.log("手续费"+l.agency_fee);console.log("count"+i.count);console.log("latefine"+i.latefine);console.log("cooperPoundge"+(i.cooperPoundge*1+5));console.log("酬金 = 违章罚款金额 + 滞纳金 + 手续费"+b.rewardself);if(i.canProcess==="0"){l.handling_state="不可办理";l.hz_display="none"}else{if(i.canProcess==="1"){console.log(b.accepProvinceCode+"-------------------------");if(b.accepProvinceCode=="44"){a("#need_receipt").show()}else{a("#need_receipt").hide()}l.handling_state="可办理";l.bl_check=j;l.hz_display="block";b.canProcess=true}}});console.error(JSON.stringify(b.arrRecordJson));var g=new d.Template();g.template_MoreToOne("illegal_JSON","id_confirm_wrap_illegal",b.arrRecordJson);dismissDialog();goTo(config.page.illegal,function(){var j=null;var i=[];a(".bl_check").on("click",function(){var k=a(this).data("code");console.error("code: "+k);if(a(this).hasClass("raido-on")){a(this).removeClass("raido-on");j=null}else{a(".bl_check").removeClass("raido-on");a(this).addClass("raido-on");j=k;console.error("arrRecordJson=========================="+JSON.stringify(b.arrRecordJson[j]));b.sureOrder.penal_sum=parseInt(b.arrRecordJson[j]["penal_sum"]);b.sureOrder.orderSeq=b.arrRecordJson[j]["punish_number"];b.sureOrder.TempID=b.violationRecord[j]["secondaryUniqueCode"];b.sureOrder.cooperPoundge=parseInt(b.arrRecordJson[j]["agency_fee"]);b.sureOrderPage.Name="";b.sureOrderPage.Phone="";b.sureOrderPage.Address="";console.error("orderSeq============="+b.arrRecordJson[j]["punish_number"])}});a("#need_receipt").on("click",function(){var k=b.arrRecordJson.bl_code;if(a(this).hasClass("raido-on")){a(this).removeClass("raido-on").addClass("raido-off");a("#sendPost_id").removeClass("sendPostShow");a("#hz_or_not").val("no")}else{a(this).addClass("raido-on").removeClass("raido-off");a("#sendPost_id").addClass("sendPostShow");a("#hz_or_not").val("yes")}});a(".illegal_list").on("click",function(){var k=a(this).parent().next(".sub-item");if(a(this).hasClass("action-up")){a(this).removeClass("action-up");k.removeClass("show-sub-item")}else{a(this).addClass("action-up");k.addClass("show-sub-item")}});document.getElementById("btn_sure").onclick=function(){if(!b.canProcess){Bestpay.Dialog.showAlertDialog("温馨提示","当前没有可缴费的记录！","确定","",function(){back()});return}if(j===null){Bestpay.Toast.makeText("请选择一张订单",Bestpay.Toast.LENGTH_SHORT);return}if(a("#hz_or_not").val()==="yes"){b.isPost="true";var k=b.mailMobile.getToEmptyValue();if(!b.mailRecept.getValue()){Bestpay.Toast.makeText("请填写收件人",Bestpay.Toast.LENGTH_SHORT);return}else{if(!k){Bestpay.Toast.makeText("请填写收件人电话号码",Bestpay.Toast.LENGTH_SHORT);return}else{if(k.length>0&&(k.length<11||k.length>11)){Bestpay.Toast.makeText("您输入的手机号码长度错误！",Bestpay.Toast.LENGTH_SHORT);return}else{if(!b.mailAddress.getValue()){Bestpay.Toast.makeText("请填写收件人地址",Bestpay.Toast.LENGTH_SHORT);return}}}}b.sureOrderPage.Name=b.mailRecept.getValue();b.sureOrderPage.Phone=b.mailMobile.getValue();b.sureOrderPage.Address=b.mailAddress.getValue()}console.log("=================go to 酬金 ==================");console.log("sureOrderPage=="+JSON.stringify(b.sureOrderPage));b.itJudgeLocalStorage=new d.JudgeLocalStorage();b.itJudgeLocalStorage.checkOrder(b.sureOrderPage.searchNo,b.sureOrderPage.amount_val*1,c.getCurrentTime(),function(){b.queryStart();b.callQuickTradingQuery();b.defferred.done(b.goPayAnimation)},b.businessName)}})};e.prototype.gotoOrder=function(g){c.getRandomServices(function(i){var h=i;if(i.code===config.RES.SUCCESS){b.random=i.randNum}b.gotoRecharge(g)},false)};e.prototype.queryStart=function(){var g=this;g.defferred=a.Deferred();showDialog()};e.prototype.queryEnd=function(){var g=this;var h={businessName:g.businessName,accountName:"交通罚款",accouontValue:g.sureOrderPage.searchNo,rechargeMoney:g.sureOrderPage.amount_val,rewardMoney:g.sureOrderPage.reward,jfyBalance:g.orderPageJson.jfy_amount,tybBalance:g.orderPageJson.tyb_amount,enablePassword:g.noPwd,userInfo:g.userInfo,callback:g.gotoOrder};console.log("pluginParam = "+JSON.stringify(h));g.paymentPlugin=new d.paymentPlugin(h);dismissDialog();goTo(config.page.comfirm,function(){});g.defferred.resolve()};e.prototype.goPayAnimation=function(){console.log("done=========================");a("#order_comfirm").removeClass("backPayAnimation").addClass("goPayAnimation")};e.prototype.stpyqueErrorCallback=function(g){if(g.code===config.RES.MONEY_NOT_ENOUGH){Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",g.code,function(){});return}};e.prototype.stpyOrderQuery=function(){var g=this;c.callCPSService({service:config.CPS.STPY_ORDER,params:b.stpyOrderqueParams(),showLoading:false,success:b.stpyOrderqueSuccessCallback,error:b.stpyOrderqueErrorCallback})};e.prototype.stpyOrderqueParams=function(){var g=this;var h={searchNo:b.orderPageJson.car_number_val,searchTime:f.getDate_YYYYMMDD()+""+f.getTime_HHMMSS()};h=c.setCPSCommonParams(h);console.log("交通罚款违章订单查询 STpy002 入参======="+JSON.stringify(h));return h};e.prototype.stpyOrderqueSuccessCallback=function(g){if(g.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code)}console.log("交通罚款违章订单查询 STpy002出参========"+JSON.stringify(g))};e.prototype.callQuickTradingQuery=function(){var g=this;c.callCPSService({service:config.CPS.QUICK_TRADING_QUERY,params:g.quickTradingQueryParams(),showLoading:false,success:g.quickTradingQuerySuccessCallback})};e.prototype.quickTradingQueryParams=function(){var g=this;var h={};h=c.setCPSCommonParams(h);console.log("免密交易查询接口入参"+JSON.stringify(h));return h};e.prototype.quickTradingQuerySuccessCallback=function(g){console.log("=======免密交易查询成功=======");if(g.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code);return}console.log("免密交易查询接口出参"+JSON.stringify(g));b.quickTranInfo={perAmount:g.perAmount,allAmount:g.allamount,allTransAction:g.alltransaction};b.handleIsneedpassword()};e.prototype.handleIsneedpassword=function(){var i=this;var h=b.quickTranInfo;var g=f.yuan2fen(b.sureOrder.penal_sum+b.sureOrder.cooperPoundge);console.log("amount : "+g);console.log("quickTranInfo : "+JSON.stringify(h));if(g*1<=1*h.perAmount&&(g*1+1*h.allTransAction)<=1*h.allAmount){b.noPwd=false}else{b.noPwd=true}console.log("self.userInfo.authenStatus=="+i.userInfo.authenStatus);if(i.userInfo.authenStatus=="A02"){console.log("self.userInfo.hadEpt  "+i.userInfo.hadEpt);if(i.userInfo.hadEpt==1){i.getFinancialProducts()}else{i.fundAccountBalanceInquiry()}}else{i.fundAccountBalanceInquiry()}};e.prototype.getFinancialProducts=function(){var g=this;c.callCPSService({service:config.CPS.FINANCIAL_PRODUCTS,params:g.getFinancialProductsParams(),showLoading:false,success:g.getFinancialProductsSuccessCallback})};e.prototype.getFinancialProductsParams=function(){var g=this;var h={};h=c.setCPSCommonParams(h);return h};e.prototype.getFinancialProductsSuccessCallback=function(i){if(i.code!==config.RES.SUCCESS){if(i.code==="018888"){b.fundAccountBalanceInquiry();return}else{Bestpay.Dialog.showAlertDialog("提醒",i.content,"确定",i.code);return}}var h=i.datas;for(var g=0;g<h.length;g++){b.orderPageJson.productId=h[g]["productId"];b.orderPageJson.userId=h[g]["userId"];b.orderPageJson.tyb_amount=f.fen2yuan(h[g]["balance"])}b.fundAccountBalanceInquiry()};e.prototype.fundAccountBalanceInquiry=function(){var g=this;c.callCPSService({service:config.CPS.CCOUNT_BALANCE_QUERY,params:g.fundAccountBalanceInquiryParams(),showLoading:false,success:g.fundAccountBalanceInquirySuccessCallback})};e.prototype.fundAccountBalanceInquiryParams=function(){var g=this;var h={bankMode:g.userInfo.bankMode};h=c.setCPSCommonParams(h);return h};e.prototype.fundAccountBalanceInquirySuccessCallback=function(l){if(l.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",l.content,"确定",l.code);return}console.log("资金账户余额查询 SAcc003出参======="+JSON.stringify(l));var o=l.dayLimit;var p=l.dayTotal;var r=o*1-p*1;var n=l.monthLimit;var i=l.monthTotal;var h=n*1-i*1;var k=l.motherBoard;var j=l.accountItems;for(var s=0;s<j.length;s++){var m=j[s]["acctType"];if(m!=null||m!="null"||m!="undefined"||m!=""){if("0007"==m){var q=j[s].activeBalance;b.orderPageJson.jfy_amount=f.fen2yuan(q);break}}}if(config.CARD_TYPE.BANK_MODE_FUND_POOL_MEMBER_CARD===b.userInfo.bankMode){var g="";if(o==="0"){g=k}else{if(k>r){g=r}else{g=k}}if(n==="0"){g=k}else{if(k>h){g=h}else{g=k}}b.orderPageJson.jfy_amount=f.fen2yuan(g);console.log("子卡＝＝＝＝trafficfinesSelf.orderPageJson['jfy_amount']=="+b.orderPageJson.jfy_amount)}b.getCommission()};e.prototype.getCommission=function(){var g=this;console.log("酬金查询金额："+f.yuan2fen(b.sureOrder.penal_sum));console.log("酬金 = 违章罚款金额 + 滞纳金 + 手续费"+b.rewardself);c.getCommission(config.BUS_TYPE.BUS_TYPE_TRAFFIC_FINES,config.BUS_CODE.TRAFFIC_FINES,config.BUS_CODE.TRAFFIC_FINES,b.rewardself,function(i){var h=i;if(i.code===config.RES.SUCCESS){h.commission=f.fen2yuan(i.reward)}else{if(i.code===config.CODE.COMMOSSION_ERROR){h.code=config.RES.SUCCESS;h.commission="0.00"}else{h.code=config.RES.UNKNOWN_ERROR;h.content=config.RES.UNKNOWN_ERROR_MSG}}b.reward=h.commission;console.log("commission================="+h.commission);showDialog(config.MSG.loading);b.initConfirm()},false)};e.prototype.initConfirm=function(){var g=this;console.log("订单页面初始化");a("#mailAddress").hide();b.sureOrderPage.searchNo=(b.orderPageJson.car_number_val).toUpperCase();b.sureOrderPage.carOwner=b.sureOrder.carOwner;b.sureOrderPage.amount_val=b.sureOrder.penal_sum+b.sureOrder.cooperPoundge;b.sureOrderPage.reward=b.reward;if(!!b.sureOrderPage.Address){a("#mailAddress").show()}console.log(JSON.stringify(b.sureOrderPage));g.queryEnd()};e.prototype.gotoRecharge=function(h){var g=this;config.TRADE_LIST_QUERY_NUMBER=g.orderPageJson.car_number_val;config.isBack=function(){back()};c.getRandomServices(function(i){var j=i;if(i.code===config.RES.SUCCESS){b.random=i.randNum}b.transportationFinesPayment(h)},false)};e.prototype.transportationFinesPayment=function(h){var g=this;c.callCPSService({service:config.CPS.TRANSPORTATION_FINES_PAYMENT,params:b.transportationFinesPaymentParams(h),showLoading:true,success:b.transportationFinesPaymentSuccessCallback,error:b.transportationFinesPaymentErrorCallback})};e.prototype.transportationFinesPaymentParams=function(h){var i=this;var j="";if(h!=null&&h!=""){j=h}console.log("trafficfinesSelf.carEngineLen == "+b.carEngineLen);var g={passWord:Bestpay.Security.encryptPassword(i.userInfo.staffCode,j,i.random),payAmount:f.yuan2fen(b.sureOrderPage.amount_val),systemNo:b.systemNo,payCardCode:i.orderPageJson.car_number_val,carEngine:i.orderPageJson.engine_number_val,carCode:i.orderPageJson.chassis_number_val,isPost:b.isPost,orderConfig:'{"Name":"'+b.sureOrderPage.Name+'","Phone":"'+b.sureOrderPage.Phone+'","CardNo":"","Address":"'+b.sureOrderPage.Address+'"}',preOrderDetails:'[{"TempID":"'+b.sureOrder.TempID+'"}]',orderSeq:f.getDate_YYYYMMDD()+""+f.getTime_HHMMSS(),payTime:f.getDate_YYYYMMDD()+""+f.getTime_HHMMSS()};g.phone="";if(i.userInfo.hadEpt.toString()=="1"){g.costWay=i.paymentPlugin.getPayType();g.productId=i.productId;g.userId=i.orderPageJson.userId}g=c.setCPSCommonParams(g);g.preOrderDetails=['{"TempID":"'+b.sureOrder.TempID+'"}'];console.log("交通罚款缴费 TTpy003 入参======="+JSON.stringify(g));b.sureOrderPage.orderSeq=g.orderSeq;return g};e.prototype.transportationFinesPaymentSuccessCallback=function(g){console.log("result==========="+JSON.stringify(g));PasswordKeyBoard.hideKeyboardUI3();if(g.code!==config.RES.SUCCESS){if(g.code==config.RES.MONEY_NOT_ENOUGH){Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",g.code,function(){b.itJudgeLocalStorage.putLocalValue("","","","")});return}if(g.code=="009002"||g.code=="006751"){b.paymentPlugin.setOrderDisplay("overtime");goTo(config.page.page_float);return}if(g.code=="019998"){Bestpay.Dialog.showAlertDialog("交易结果","系统处理失败，请稍后再试","确定",g.code,function(){back();b.itJudgeLocalStorage.putLocalValue("","","","")});return}if(g.code==config.RES.PASSWORD_ERROR_LOCKED_002136){Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code,function(){App.exitCompleteApp();b.itJudgeLocalStorage.putLocalValue("","","","")})}else{Bestpay.Dialog.showAlertDialog("提醒",g.content,"确定",g.code,function(){back();b.itJudgeLocalStorage.putLocalValue("","","","")})}return}b.itJudgeLocalStorage.putLocalValue("","","","");b.paymentPlugin.setOrderDisplay("success");goTo(config.page.page_float);config.isBack=function(){if(window.jqXHR.readyState>2){Bestpay.App.exitApp()}}};e.prototype.transportationFinesPaymentErrorCallback=function(g){console.log("result error==========="+JSON.stringify(g));if(g.code===config.RES.MONEY_NOT_ENOUGH){b.itJudgeLocalStorage.putLocalValue("","","","");Bestpay.Dialog.showAlertDialog("提醒","余额不足","确定",g.code,function(){});return}};return e});