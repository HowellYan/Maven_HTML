define(["jquery","bestpay.ui","bestpay.lang","bestpay.http","jtemplates"],function(e,b,f,h,g){function d(k){return document.getElementById(k)}function a(){var n=new Date();var l=n.getFullYear();var m=n.getMonth()+1;var p=n.getDate()+1;m=m<10?"0"+m:m;p=p<10?"0"+p:p;var q=n.getDay()+1;var k=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];q=k[q];var o=l+"-"+m+"-"+p+"("+q+")";return(o)}var i=new c();function c(){i=this;this.twoJsonArray=new Array();this.manageM=config.man.manageM;this.manageMOpenAnAccount=config.man.manageMOpenAnAccount;this.zhuangru_true=false;this.zhuangchu_true=false;this.logoList={"866000":"images/bank/yzyh.png","866100":"images/bank/zgyh.png","866200":"images/bank/gsyh.png","866300":"images/bank/nyyh.png","866400":"images/bank/jtyh.png","866500":"images/bank/jsyh.png","866600":"images/bank/msyh.png","866700":"images/bank/hxyh.png","866800":"images/bank/gfyh.png","866900":"images/bank/zsyh.png","867000":"images/bank/gzyh.png","867200":"images/bank/gdyh.png","867400":"images/bank/zxyh.png","867600":"images/bank/xyyh.png","865700":"images/bank/payh.png","865500":"images/bank/shyh.png"};this.orderPageJson={};this.random=null;this.zhuanru_passWord=null;this.zhuangchu_password=null;this.iAdd="0";this.iAddyield="0"}c.prototype.financialProblemQuery=function(){var k=this;h.callCPSService({service:config.CPS.FINANCIAL_PROBLEM_QUERY,params:i.financialProblemQueryParams(),showLoading:true,success:i.financialProblemQuerySuccessCallback})};c.prototype.financialProblemQueryParams=function(){var k=this;var l={producttypeId:"01"};l=h.setCPSCommonParams(l);console.log("理财问题查询接口（SEpt015）====入参==="+JSON.stringify(l));return l};c.prototype.financialProblemQuerySuccessCallback=function(o){config.page.id_shouzhifour_show.prompt_show_back=true;console.log(config.page.id_shouzhifour_show.prompt_show_back+"config.page.id_shouzhifour_show.prompt_show_back = true;  ABC 015");console.log("理财问题查询接口（SEpt015)=====出参===="+JSON.stringify(o));if(o.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",o.content,"确定",o.code);return}config.man.manageMOpenAnAccount.messageAnnouncement();Bestpay.App.setTitle("服务中心");if(i.manageMOpenAnAccount.anountcementisBack*1==1){e("#brg_amount_question").show();i.manageM.selectType_question.setChecked("anount_question");i.manageM.questionandinformation=2;e("#changjian_question").hide();e("#gongkao_information").show();e("#id_anountmentBoxLeft").show();e("#id_anountmentBoxRight").hide();console.log("gong111");back()}i.DATAS=o.datas;var n="";var l="";if(i.DATAS!==null&&i.DATAS!=="null"&&i.DATAS!==""&&i.DATAS.length!==0&&i.DATAS!=="undefined"&&typeof i.DATAS!=="undefined"){if(i.manageM.questionandinformation==1){console.log("otherSelf.manageM.questionandinformation=="+i.manageM.questionandinformation);e("#gongkao_information").hide();e("#changjian_question").show()}else{e("#gongkao_information").show();e("#changjian_question").hide()}for(var k=0;k<i.DATAS.length;k++){var m=i.DATAS[k];l=m.problemtypeName;i.twoJsonArray[k]=m.temfProblemList;n+='<div class ="confirm-item_g question_item" data-code = '+k+">"+l+"</div>"}e("#id_optionsBoxLeft").html(n);i.getProblemtypeId();i.manageM.config_togo=false}else{e("#changjian_question").hide()}goTo(config.page.service_center);config.isBack=function(){console.log("AAA");back();e("#first_anouncement").hide()}};c.prototype.getProblemtypeId=function(){var k=this;e(".question_item").each(function(){e(this).on("click",function(){e("#id_optionsBoxLeft").hide();e("#id_optionsBoxRight").show();e("#brg_amount_question").hide();i.manageM.config_togo=true;var o=" ",m=e(this).data("code"),n=i.twoJsonArray[m];for(var p=0;p<n.length;p++){var l=n[p];o+='<div class="con"><div class="confirm_item_title confirm-item_g">'+l.title+'</div><div class="item_menu">'+l.contents+"</div></div>"}e("#id_optionsBoxRight").html(o);i.getcodeHTML()})})};c.prototype.getcodeHTML=function(){var k=this;e(".item_menu:first").show();e(".confirm_item_title:first").removeClass("confirm-item_g_s").addClass("confirm-item_g_s");e(".confirm_item_title").each(function(){e(this).on("click",function(){var l=e(".confirm_item_title").index(e(this));e(this).siblings(".item_menu").toggle();e(this).parent().siblings().children(".item_menu").hide();e(this).toggleClass("confirm-item_g_s");e(this).parent().siblings().children(".confirm_item_title").removeClass("confirm-item_g_s")})});config.isBack=function(){e("#id_optionsBoxLeft").show();e("#id_optionsBoxRight").hide();e("#brg_amount_question").show()}};c.prototype.accountBankInfo=function(){var k=this;h.callCPSService({service:config.CPS.ACCOUNT_BANK_INFO,params:k.accountBankInfoParams(),showLoading:false,success:k.accountBankInfoSuccessCallback})};c.prototype.accountBankInfoParams=function(){var k=this;var l={};l=h.setCPSCommonParams(l);console.log("账户银行信息查询接口 SCbk001入参======="+JSON.stringify(l));return l};c.prototype.accountBankInfoSuccessCallback=function(k){if(k.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code);return}console.log("账户银行信息查询接口 SCbk001出参======="+JSON.stringify(k));console.log("123123:"+config.logoList[k.bankCode]);i.orderPageJson.bankName=k.bankName;i.orderPageJson.img_src=config.logoList[k.bankCode];i.orderPageJson.bankAcctNbr=k.bankAcctNbr.substr(k.bankAcctNbr.length-4,4);i.orderPageJson.bankAcctName="*"+k.bankAcctName.substring(1,k.bankAcctName.length);h.getAccountBalanceInquiry(i.getAccountBalanceInquirySuccessCallback,false)};c.prototype.WorkDayAndWorkWeekShow=function(){var p=config.man.manageMOpenAnAccount.orderPageJson.confirmWorkDay;var n=config.man.manageMOpenAnAccount.orderPageJson.confirmWorkWeek;var m=p.substring(0,4);var o=p.substring(4,6);var k=p.substring(p.length-2);var l=n.substring(n.length-1);e("#WorkDayAndWorkWeek").html(m+"-"+o+"-"+k+"(星期"+l+")")};c.prototype.getAccountBalanceInquirySuccessCallback=function(k){if(k.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code);return}var p=k.accountItems;for(var o=0;o<p.length;o++){var q=p[o]["acctType"];if(q!=null||q!="null"||q!="undefined"||q!=""){if("0007"==q){var n=p[o].activeBalance;i.orderPageJson.activeBalance=f.getThausand(f.fen2yuan(n),1);i.orderPageJson.activeBalanceNoDou=f.fen2yuan(n);e("#autoActiveBalance").html(f.getThausand(f.fen2yuan(n),1));break}}}i.manageM.zhuanru_money_text.clearValue();i.manageM.zhuanchu_money_text.clearValue();i.textT(".bank_span","");i.orderPageJson.balance=i.manageMOpenAnAccount.orderPageJson.balance;if(i.manageM.applyatoneGet=="1"){var l=new b.Template();l.template_OneToOne("id_zhuangru_wrap",i.orderPageJson);if(i.manageM.zhuanruApplybuy*1==1){e("#help_cont_ZU1").show();e("#help_cont_ZU2").hide();i.manageM.bindCardZhuanru()}else{e("#help_cont_ZU1").hide();e("#help_cont_ZU2").show();e("#jy_btn_show").show();e("#input-wrap_zru_wrap").show();i.WorkDayAndWorkWeekShow()}goTo(config.page.changeover_Pay_easy);e(".cont_btn_gray_a").removeClass("cont_btn_blue_a");i.purchaseAndVerification();config.isBack=function(){console.log("otherSelf.manageM.kaohu_zhuangru_immediately=="+i.manageM.kaohu_zhuangru_immediately);if(i.manageM.kaohu_zhuangru_immediately==1){location.reload()}else{back()}}}else{var s=new b.Template();s.template_OneToOne("id_zhuangchu_wrap",i.orderPageJson);if(i.manageM.zhuangchuatonefor*1==1){e("#help_cont_CHU1").show();e("#help_cont_CHU2").hide();i.manageM.bindCardZhuanchu()}else{e("#help_cont_CHU1").hide();e("#help_cont_CHU2").show();e("#input-wrap_zchu_wrap").show();e("#jf_btn_show").show()}goTo(config.page.roll_out_Pay_easy);e(".cont_btn_gray_a").removeClass("cont_btn_blue_a");var m=function(t){if(t.length>=6){console.log("3333");e(".cont_btn_gray_a").addClass("cont_btn_blue_a")}else{console.log("4444");e(".cont_btn_gray_a").removeClass("cont_btn_blue_a")}};var r=function(){e(".cont_btn_gray_a").removeClass("cont_btn_blue_a")};i.redemptionOfPreCheck()}};c.prototype.getAutomaticSuccessCallback=function(k){console.log("余额查询 自动转入先调交费易余额查询 出参======="+JSON.stringify(k));if(k.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code);return}var m=k.accountItems;for(var l=0;l<m.length;l++){var n=m[l]["acctType"];if(n!=null||n!="null"||n!="undefined"||n!=""){if("0007"==n){var o=m[l].activeBalance;e("#autoActiveBalance").html(f.getThausand(f.fen2yuan(o),1));break}}}config.man.manageMOpenAnAccount.autoCheckSettingInterface()};c.prototype.sortNumber=function(l,k){return l-k};c.prototype.comparefour=function(){var l=this;l.more_value_zu="";var m=[i.rMaxvalue,i.singleMaxvalue,i.yMaxvalue,i.activeBalance];var k=[i.rMaxvalue,i.singleMaxvalue,i.yMaxvalue];m.sort(l.sortNumber);k.sort(l.sortNumber);if(i.manageM.zhuanruApplybuy*1===2){l.more_value_zu=m[0];e("#zhuanru_money_text").attr("placeholder","最多"+f.getThausand(f.fen2yuan(l.more_value_zu),1)+"元");e("#rumaxAmount").text("本次最多可转入"+f.getThausand(f.fen2yuan(l.more_value_zu),1)+"元")}else{l.more_value_zu=k[0];l.more_value_zuThansoud="1000";e("#zhuanru_money_text").attr("placeholder","至少转入"+l.more_value_zuThansoud+"元");e("#rumaxAmount").text("该卡本次最多可转入"+f.getThausand(f.fen2yuan(l.more_value_zu),1)+"元")}};c.prototype.compareZhuangCHU=function(){var k=this;var l="";var m=[i.rMaxvalueChu,i.singleMaxvalueChu,i.yMaxvalueChu,i.balanceChu];m.sort(i.sortNumber);l=m[0];if(i.manageM.zhuangchuatonefor*1==1){e("#chumaxAmount").text("")}else{e("#chumaxAmount").text("")}e("#zhuanchu_money_text").attr("placeholder","最多"+f.getThausand(f.fen2yuan(l),1)+"元")};c.prototype.textT=function(l,k){e(l).html(k)};c.prototype.purchaseAndVerification=function(){var k=this;h.callCPSService({service:config.CPS.PURCHASE_AND_VERIFICATION,params:k.purchaseAndVerificationParams(),showLoading:false,success:k.purchaseAndVerificationSuccessCallback})};c.prototype.purchaseAndVerificationParams=function(){var k=this;var l={productId:k.manageMOpenAnAccount.productId};l=h.setCPSCommonParams(l);console.log("3.5企业理财申购预校验(MEpt002)入参======="+JSON.stringify(l));return l};c.prototype.purchaseAndVerificationSuccessCallback=function(k){var s=this;dismissDialog();if(k.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code);return}console.log("3.5企业理财申购预校验(MEpt002)出参======="+JSON.stringify(k));i.zhuanru_money_text_val=i.manageM.zhuanru_money_text.getToEmptyValue();var q=k.rMaxvalue;var l=k.rMax;var r=k.singleLimitvalue;var o=k.singleMaxvalue;var p=k.yMaxvalue;var n=k.yMax;i.rMaxvalue=k.rMaxvalue;i.singleMaxvalue=k.singleMaxvalue;i.yMaxvalue=k.yMaxvalue;i.activeBalance=f.yuan2fen(i.orderPageJson.activeBalanceNoDou);if(o==null||o==""||o=="undefined"||(typeof r==="undefined")||q==null||q==""||q=="undefined"||(typeof q==="undefined")||p==null||p==""||p=="undefined"||(typeof p==="undefined")){e("#rumaxAmount").text("");e("#zhuanru_money_text").attr("placeholder","");i.comparefour()}else{i.comparefour()}function m(){i.zhuangru_true=false;i.zhuanru_money_text_val=i.manageM.zhuanru_money_text.getToEmptyValue();i.zhuanru_money_text_val=f.yuan2fen(i.zhuanru_money_text_val);if(i.zhuanru_money_text_val!=null||s.zhuanru_money_text_val.length!=0){e("#jy_btn_show").addClass("cont_btn_blue")}else{e("#jy_btn_show").addClass("cont_btn_gray").removeClass("cont_btn_blue")}if(i.zhuanru_money_text_val*1==0){i.textT(".bank_span","输入金额不能为0");return}if(l!=null&&l!=""&&l!=undefined){if(l>0){i.textT(".bank_span","")}else{i.textT(".bank_span","转入次数已超过单日最大笔数");return}}if(n!=null&&n!=""&&n!=undefined){if(n>0){i.textT(".bank_span","")}else{i.textT(".bank_span","当月最大笔数转入次数超限");return}}if(o!=null&&o!=""&&o!=undefined){if(i.zhuanru_money_text_val*1>o){i.textT(".bank_span","单笔最高金额超过有效数");return}else{i.textT(".bank_span","")}}if(q!=null&&q!=""&&q!=undefined){if(i.zhuanru_money_text_val*1>q){i.textT(".bank_span","转入金额超过单日最高金额，请重新输入");return}else{i.textT(".bank_span","")}}if(p!=null&&p!=""&&p!=undefined){if(i.zhuanru_money_text_val*1>p){i.textT(".bank_span","转入金额超过月最高金额");return}else{i.textT(".bank_span","")}}if(i.manageM.zhuanruApplybuy*1==1){if(i.zhuanru_money_text_val*1<100000){i.textT(".bank_span","单笔最低金额必须大于1000元");return}else{i.textT(".bank_span","")}}else{if(r!=null&&r!=""&&r!=undefined){if(i.zhuanru_money_text_val*1<r){i.textT(".bank_span","单笔最低金额必须大于"+(r/100).toFixed(0)+"元");return}else{i.textT(".bank_span","")}}if(i.zhuanru_money_text_val*1>i.activeBalance*1){i.textT(".bank_span","转入金额超出账户余额");return}else{i.textT(".bank_span","")}}i.zhuangru_true=true}d("zhuanru_money_text").addEventListener("input",m)};c.prototype.getapplyforBuySecretInterface=function(l){var m=this;i.orderPageJson.txnAmount=f.getThausand(f.fen2yuan(this.zhuanru_money_text_val),1);var k=new b.Template();k.template_OneToOne("id_applyBuysceret",i.orderPageJson);h.getRandomServices(function(n){var o=n;if(n.code===config.RES.SUCCESS){i.random=n.randNum}i.financialPurchase(l);config.isBack=function(){back();return}},false)};c.prototype.getapplyforBuySuccess=function(){var k=this};c.prototype.financialPurchase=function(l){var k=this;h.callCPSService({service:config.CPS.FINANCIAL_PURCHASE,params:k.financialPurchaseParams(l),showLoading:true,success:k.financialPurchaseSuccessCallback})};c.prototype.financialPurchaseParams=function(m){var n=this;var k="";if(m!=null&&m!=""){k=m}var l={payPassword:Bestpay.Security.encryptPassword(n.manageM.userInfo.staffCode,k,n.random),txnAmount:this.zhuanru_money_text_val,txnType:n.manageM.zhuanruApplybuy,productId:n.manageMOpenAnAccount.productId,userId:n.manageMOpenAnAccount.userId};l=h.setCPSCommonParams(l);console.log("3.6企业理财申购 (TEpt004)入参===="+JSON.stringify(l));return l};c.prototype.financialPurchaseSuccessCallback=function(k){dismissDialog();PasswordKeyBoard.hideKeyboardUI3();if(k.code!==config.RES.SUCCESS){if(k.code==config.RES.PASSWORD_ERROR_LOCKED_002136){Bestpay.Dialog.showAlertDialog("提醒",config.RES.PASSWORD_ERROR_LOCKED_002136_MSG,"确定",k.code,function(){App.exitCompleteApp()})}else{if(k.code==config.RES.PASSWORD_ERROR_LOCKED_020004){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code,function(){App.exitCompleteApp()})}else{Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code)}}return}if(i.manageM.zhuanruApplybuy*1==2){App.queryBalance()}console.log("3.6企业理财申购 (TEpt004)出参===="+JSON.stringify(k));i.orderPageJson.transSeq=k.transSeq;i.orderPageJson.txnAmountZRU=i.orderPageJson.txnAmount;i.orderPageJson.interestDate=k.interestDate+"("+k.interestWeek+")";var l=new b.Template();l.template_OneToOne("id_zhuangru_success",i.orderPageJson);goTo(config.page.zhuangrusuccess);config.isBack=function(){location.reload()}};c.prototype.redemptionOfPreCheck=function(){var k=this;h.callCPSService({service:config.CPS.REDEMPTION_OF_PRE_CHECK,params:k.redemptionOfPreCheckParams(),showLoading:false,success:k.redemptionOfPreCheckSuccessCallback})};c.prototype.redemptionOfPreCheckParams=function(){var k=this;var l={productId:k.manageMOpenAnAccount.productId};l=h.setCPSCommonParams(l);console.log("3.5企业理财申购预校验(MEpt003)入参======="+JSON.stringify(l));return l};c.prototype.redemptionOfPreCheckSuccessCallback=function(l){var k=this;dismissDialog();if(l.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",l.content,"确定",l.code);return}console.log("3.5企业理财申购预校验(MEpt003)出参======="+JSON.stringify(l));i.zhuanchu_money_text_val=i.manageM.zhuanchu_money_text.getToEmptyValue();var s=l.rMaxvalue;var m=l.rMax;var t=l.singleLimitvalue;var q=l.singleMaxvalue;var r=l.yMaxvalue;var p=l.yMax;i.rMaxChu=l.rMax;i.rMaxvalueChu=l.rMaxvalue;i.singleMaxvalueChu=l.singleMaxvalue;i.yMaxvalueChu=l.yMaxvalue;i.balanceChu=f.yuan2fen(i.manageMOpenAnAccount.orderPageJson.balanceNoneDou);var o=f.yuan2fen(i.manageMOpenAnAccount.orderPageJson.balanceNoneDou);if(q==null||q==""||q=="undefined"||(typeof t==="undefined")||s==null||s==""||s=="undefined"||(typeof s==="undefined")||r==null||r==""||r=="undefined"||(typeof r==="undefined")){e("#chumaxAmount").text("");e("#zhuanchu_money_text").attr("placeholder","");i.compareZhuangCHU()}else{i.compareZhuangCHU()}i.textT(".rmaxbank_span",'今天还可以转出<span class="orange">'+i.rMaxChu+"</span>次");function n(){i.zhuangchu_true=false;i.zhuanchu_money_text_val=i.manageM.zhuanchu_money_text.getToEmptyValue();i.zhuanchu_money_text_val=f.yuan2fen(i.zhuanchu_money_text_val);if(i.zhuanchu_money_text_val!=null||k.zhuanchu_money_text_val.length!=0){e("#jf_btn_show").addClass("cont_btn_blue")}else{e("#jf_btn_show").addClass("cont_btn_gray").removeClass("cont_btn_blue")}if(i.zhuanchu_money_text_val*1==0){i.textT(".bank_span","输入金额不能为0");return}if(m!=null&&m!=""&&m!=undefined){if(m>0){i.textT(".bank_span","")}else{i.textT(".bank_span","转出次数已超过单日最大笔数");return}}if(p!=null&&p!=""&&p!=undefined){if(p>0){i.textT(".bank_span","")}else{i.textT(".bank_span","当月最大笔数转出次数超限");return}}if(q!=null&&q!=""&&q!=undefined){if(i.zhuanchu_money_text_val*1>q){i.textT(".bank_span","单笔最高金额超过有效数");return}else{i.textT(".bank_span","")}}if(t!=null&&t!=""&&t!=undefined){if(i.zhuanchu_money_text_val*1<t){i.textT(".bank_span","单笔最低金额必须大于"+(t/100).toFixed(0)+"元");return}else{i.textT(".bank_span","")}}if(s!=null&&s!=""&&s!=undefined){if(i.zhuanchu_money_text_val*1>s){i.textT(".bank_span","转出金额超过单日最高金额，请重新输入");return}else{i.textT(".bank_span","")}}if(r!=null&&r!=""&&r!=undefined){if(i.zhuanchu_money_text_val*1>r){i.textT(".bank_span","转出金额超过月最高金额");return}else{i.textT(".bank_span","")}}if(i.zhuanchu_money_text_val*1>o*1){i.textT(".bank_span","转出金额超出添益宝账户余额");return}else{i.textT(".bank_span","")}i.zhuangchu_true=true}d("zhuanchu_money_text").addEventListener("input",n)};c.prototype.getatoneForSecretInterface=function(l){var m=this;i.orderPageJson.txnAmountchu=f.getThausand(f.fen2yuan(m.zhuanchu_money_text_val),1);if(i.manageM.zhuangchuatonefor*1==1){i.orderPageJson.bankAcctNbrBR=i.orderPageJson.bankName+"("+i.orderPageJson.bankAcctNbr+")";e("#bank_cont_success").show();e("#jfy_cont_success").hide()}else{i.orderPageJson.bankAcctNbrBR="账户";e("#bank_cont_success").hide();e("#jfy_cont_success").show()}var k=new b.Template();k.template_OneToOne("id_atoneforsecret",i.orderPageJson);h.getRandomServices(function(n){var o=n;if(n.code===config.RES.SUCCESS){i.random=n.randNum}m.financialRedemption(l);config.isBack=function(){back();return}},false)};c.prototype.getatoneForSuccess=function(){};c.prototype.financialRedemption=function(l){var k=this;h.callCPSService({service:config.CPS.FINANCIAL_REDEMPTION,params:k.financialRedemptionParams(l),showLoading:true,success:k.financialRedemptionSuccessCallback})};c.prototype.financialRedemptionParams=function(m){var n=this;var k="";if(m!=null&&m!=""){k=m}var l={payPassword:Bestpay.Security.encryptPassword(n.manageM.userInfo.staffCode,k,n.random),txnAmount:this.zhuanchu_money_text_val,txnType:n.manageM.zhuangchuatonefor,productId:n.manageMOpenAnAccount.productId,userId:n.manageMOpenAnAccount.userId};l=h.setCPSCommonParams(l);return l};c.prototype.financialRedemptionSuccessCallback=function(k){PasswordKeyBoard.hideKeyboardUI3();dismissDialog();if(k.code!==config.RES.SUCCESS){if(k.code==config.RES.PASSWORD_ERROR_LOCKED_002136){Bestpay.Dialog.showAlertDialog("提醒",config.RES.PASSWORD_ERROR_LOCKED_002136_MSG,"确定",k.code,function(){App.exitCompleteApp()})}else{if(k.code==config.RES.PASSWORD_ERROR_LOCKED_020004){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code,function(){App.exitCompleteApp()})}else{Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code)}}return}i.orderPageJson.txnAmountZCHU=i.orderPageJson.txnAmountchu;if(i.manageM.zhuangchuatonefor*1==1){i.orderPageJson.bankAcctNbr=i.orderPageJson.bankAcctNbr}else{App.queryBalance()}var l=new b.Template();l.template_OneToOne("id_atonefor_success_bank",i.orderPageJson);goTo(config.page.roll_out_success);config.isBack=function(){location.reload()}};c.prototype.financialIncomeinterface=function(){var k=this;goTo(config.page.accumulated_in);if(k.manageM.shouyitwo==2||k.manageM.shouyitwo==3){k.millionCopiesOfRevenue()}else{k.financialIncomeQuery()}};c.prototype.financialIncomeQuery=function(){var k=this;h.callCPSService({service:config.CPS.FINANCIAL_INCOME_QUERY,params:k.financialIncomeQueryParams(),showLoading:true,success:k.financialIncomeQuerySuccessCallback})};c.prototype.financialIncomeQueryParams=function(){var k=this;var l={selectType:k.manageM.shouyitwo,userId:k.manageMOpenAnAccount.userId};l=h.setCPSCommonParams(l);console.log("企业理财收益查询接口(SEpt007)"+JSON.stringify(l));return l};c.prototype.financialIncomeQuerySuccessCallback=function(k){if(k.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code);return}e("#check_text_T").html("");console.log("企业理财收益查询接口(SEpt007)"+JSON.stringify(k));e("#get_money").show();e("#Noget_leiji_page").hide();e("#leijyImg").attr("src","images/get_math.png");e("#leijyImg").removeClass("leijyImg_s").addClass("leijyImg");i.orderPageJson.income=f.getThausand(f.fen2yuan(k.income),1);var n=new b.Template();n.template_OneToOne("id_income_wrap",i.orderPageJson);var o=k.datas;i.arrDIVSeven=new Array();i.arrDIVSevenDays=new Array();var p="";if(o==null||o==""||o.length<=0||o=="undefined"){e("#check_text_T").hide();e("#Noget_leiji_page").show()}else{e("#check_text_T").show();e("#Noget_leiji_page").hide();for(var m=0;m<o.length;m++){i.transactioncfmDate7=o[m]["transactioncfmDate"];i.dividendVol7=o[m]["dividendVol"];i.arrDIVSeven[i.arrDIVSeven.length]=o[m]["dividendVol"]*1;i.arrDIVSevenDays[i.arrDIVSevenDays.length]=o[m]["transactioncfmDate"]}i.maxarrSeven=j(i.arrDIVSeven,"max");console.log(i.maxarrSeven+"= otherSelf.maxarrSeven CCC");for(var l=0;l<i.arrDIVSeven.length;l++){i.percentMaxSeven=i.arrDIVSeven[l]*1/i.maxarrSeven*1;if(i.percentMaxSeven*1<0.16){i.percentMaxSeven=0.16}i.percentMaxSevenPerfouth=i.percentMaxSeven*100+"%";console.log(i.arrDIVSeven[l]+" = 当前值CCC");console.log(i.percentMaxSeven+" = 得出的百分比CCC");p+='<div class="skillbar" data-percent='+i.percentMaxSevenPerfouth+'><div class="skillbar-bar"><div class="skill-left" style="background: #ff9b26">'+i.arrDIVSevenDays[l]+'</div><div class="skillR"><div class="skill-right" style="background: #ff9b26">+'+(i.arrDIVSeven[l]/100).toFixed(2)+"</div></div></div></div>"}e("#check_text_T").html(p);e(".skillbar").each(function(){e(this).find(".skill-right").animate({width:e(this).attr("data-percent")},1000)})}};c.prototype.floatAdd=function(o,n){var m,l,k;try{m=o.toString().split(".")[1].length}catch(p){m=0}try{l=n.toString().split(".")[1].length}catch(p){l=0}k=Math.pow(10,Math.max(m,l));return(o*k+n*k)/k};c.prototype.millionCopiesOfRevenue=function(){var k=this;h.callCPSService({service:config.CPS.MILLION_COPIES_OF_REVENUE,params:k.millionCopiesOfRevenueParams(),showLoading:true,success:k.millionCopiesOfRevenueSuccessCallback})};c.prototype.millionCopiesOfRevenueParams=function(){var k=this;var l={productId:k.manageMOpenAnAccount.productId};l=h.setCPSCommonParams(l);return l};function j(k,l){if(l=="max"){return Math.max.apply(Math,k)}else{if(l=="min"){return Math.min.apply(Math,k)}}}c.prototype.millionCopiesOfRevenueSuccessCallback=function(l){if(l.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",l.content,"确定",l.code);return}e("#check_text_T").html("");i.iAdd="0";i.iAddyield="0";e("#get_money").show();e("#leijyImg").attr("src","images/get_thousand.png");e("#leijyImg").addClass("leijyImg_s");var s=l.datas;i.arrDIVfouth=new Array();i.arrDIVDaysfouth=new Array();var m="";var o=e("#ul_shouyi_first").empty().append(e("<li></li>").html("日期"));if(s==null||s==""||s.length<=0||s=="undefined"){e("#check_text_T").hide()}else{e("#check_text_T").show();if(i.manageM.shouyitwo==2){e("#leijyId").text("近一月平均万份收益(元)");for(var r=0;r<s.length;r++){i.navDatefouth=s[r]["navDate"];var u=s[r]["navDate"];i.fundIncome14=parseInt(s[r]["fundIncome"]);i.fundIncomefouth=s[r]["fundIncome"];var v=(s[r]["fundIncome"]/100).toFixed(4);var q=s[r]["fundincomeFlag"];i.iAdd=i.floatAdd(i.iAdd,Number(v));i.orderPageJson.income=(i.iAdd/r).toFixed(4);i.arrDIVfouth[i.arrDIVfouth.length]=i.fundIncomefouth*1;i.arrDIVDaysfouth[i.arrDIVDaysfouth.length]=i.navDatefouth}i.maxarrfouth=j(i.arrDIVfouth,"max");console.log(i.maxarrfouth+"= otherSelf.maxarrfouth CCC");for(var p=0;p<i.arrDIVfouth.length;p++){i.percentMaxfouth=i.arrDIVfouth[p]*1/i.maxarrfouth*1;i.percentMaxPerfouth=i.percentMaxfouth*100+"%";console.log(i.arrDIVfouth[p]+" = 当前值CCC");console.log(i.percentMaxfouth+" = 得出的百分比CCC");m+='<div class="skillbar" data-percent='+i.percentMaxPerfouth+'><div class="skillbar-bar"><div class="skill-left" style="background: #ff9b26">'+i.arrDIVDaysfouth[p]+'</div><div class="skillR"><div class="skill-right" style="background: #ff9b26">'+(i.arrDIVfouth[p]/100).toFixed(4)+"</div></div></div></div>"}}else{e("#leijyId").text("近一月平均收益率");for(var r=0;r<s.length;r++){i.navDatefouth=s[r]["navDate"];var u=s[r]["navDate"];i.yyieldfourh=s[r]["yield"];var n=(s[r]["yield"]/100).toFixed(4);var t=s[r]["yieldFlag"];i.iAddyield=i.floatAdd(i.iAddyield,Number(n));i.orderPageJson.income=(i.iAddyield/r).toFixed(4)+"%";i.arrDIVfouth[i.arrDIVfouth.length]=i.yyieldfourh*1;i.arrDIVDaysfouth[i.arrDIVDaysfouth.length]=i.navDatefouth}i.maxarrfouth=j(i.arrDIVfouth,"max");console.log(i.maxarrfouth+"= otherSelf.maxarrfouth CCC");for(var p=0;p<i.arrDIVfouth.length;p++){i.percentMaxfouth=i.arrDIVfouth[p]*1/i.maxarrfouth*1;i.percentMaxPerfouth=i.percentMaxfouth*100+"%";console.log(i.arrDIVfouth[p]+" = 当前值CCC");console.log(i.percentMaxfouth+" = 得出的百分比CCC");m+='<div class="skillbar" data-percent='+i.percentMaxPerfouth+'><div class="skillbar-bar"><div class="skill-left" style="background: #ff9b26">'+i.arrDIVDaysfouth[p]+'</div><div class="skillR"><div class="skill-right" style="background: #ff9b26">+'+(i.arrDIVfouth[p]/100).toFixed(4)+"%</div></div></div></div>"}}}e("#check_text_T").html(m);e(".skillbar").each(function(){e(this).find(".skill-right").animate({width:e(this).attr("data-percent")},1000)});var k=new b.Template();k.template_OneToOne("id_income_wrap",i.orderPageJson)};c.prototype.financialRevenueAndExpenditureinterface=function(){var k=this;e("#check_text_shouzhi").hide();e(".page_current").hide();e("#shouzhi_null_text").hide();e("#shouyi_null_text").hide();goTo(config.page.income_in);k.financialRevenueAndExpenditureQuery()};c.prototype.financialRevenueAndExpenditureQuery=function(){var k=this;h.callCPSService({service:config.CPS.FINANCIAL_REVENUE_AND_EXPENDITURE_QUERY,params:k.financialRevenueAndExpenditureQueryParams(),showLoading:true,success:k.financialRevenueAndExpenditureQuerySuccessCallback})};c.prototype.financialRevenueAndExpenditureQueryParams=function(){var k=this;var l={orderType:k.manageM.shouzhifour,userId:k.manageMOpenAnAccount.userId,pageSize:"30",currentPage:k.manageM.currentPage};l=h.setCPSCommonParams(l);return l};c.prototype.financialRevenueAndExpenditureQuerySuccessCallback=function(k){if(k.code!==config.RES.SUCCESS){Bestpay.Dialog.showAlertDialog("提醒",k.content,"确定",k.code);return}e("#time_date").html("");e("#change_type").html("");e("#money_balance").html("");e("#type_type").html("");var o=k.datas;if(o==null||o==""||o.length<=0||o=="undefined"){if(i.manageM.currentPage==1){e("#check_text_shouzhi").hide();e(".page_current").hide();if(i.manageM.shouzhifour==0){e("#shouzhi_null_text").show()}else{e("#shouzhi_null_text").hide()}if(i.manageM.shouzhifour==3||i.manageM.shouzhifour==2||i.manageM.shouzhifour==1||i.manageM.shouzhifour==7){e("#shouyi_null_text").show()}else{e("#shouyi_null_text").hide()}}else{e(".page_current").hide();return}}else{e(".page_current").show();e("#check_text_shouzhi").show();e("#shouzhi_null_text").hide();e("#shouyi_null_text").hide();var n;var p;var m="";for(var l=0,q=o.length;l<q;l++){p=o[l].accDate.split(" ");if(p[0]!==n){m+='<div class="time-line">'+p[0]+"</div>"}n=p[0];m+='<div class="income-list">';m+='<div class="box income-list-top">';if(i.manageM.shouzhifour==0||i.manageM.shouzhifour==3||i.manageM.shouzhifour==7){m+='<div class="box-f1">'+o[l].typeName+'</div><div class="box-f1 incolor">+'+f.getThausand(f.fen2yuan(o[l].amount),1)+"</div>"}else{if(i.manageM.shouzhifour==1||i.manageM.shouzhifour==2){m+='<div class="box-f1">'+o[l].typeName+'</div><div class="box-f1 outcolor">-'+f.getThausand(f.fen2yuan(o[l].amount),1)+"</div>"}}m+="</div>";m+='<div class="box income-list-bottom">';m+='<div class="box-f1">'+p[1]+'</div><div class="box-f1">成功</div>';m+="</div></div>"}e("#check_text_shouzhi").html(m);if(o.length<30){e(".page_current").hide()}}};return c});